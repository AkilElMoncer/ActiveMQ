CVE 2015-5254

<img width="988" alt="Capture d’écran 2024-10-31 à 19 27 26" src="https://github.com/user-attachments/assets/fd58667a-cb77-4458-8bd6-a0f323f03e1c">

Pour commencer, lancez ActiveMQ en arrière-plan dans le dossier activemq_2015 en utilisant :
docker compose up -d

![Capture d’écran 2024-10-29 à 11 28 00](https://github.com/user-attachments/assets/b43d66fe-b8f1-40e6-aa94-a54dc856ff3d)

Accédez ensuite à l'interface d'administration dans un navigateur à l'adresse :

http://localhost:8161/admin/

Vous verrez la version d'ActiveMQ, ici (5.11.1) :

![Capture d’écran 2024-10-29 à 11 44 12](https://github.com/user-attachments/assets/137d88cf-bca6-491d-8f65-766d21fb7e52)

On peut aussi voir la version de activemq dans le fichier docker-compose.yml:
![Capture d’écran 2024-10-29 à 11 46 07](https://github.com/user-attachments/assets/125fbdbd-77fb-46a0-8c8a-acebcf745bd7)

Pour scanner le réseau afin d'identifier les services actifs et leurs versions avec la commande en vérifiant que le port 61616 est bien ouvert:
nmap -p- 192.168.1.145

![Capture d’écran 2024-10-29 à 11 47 06](https://github.com/user-attachments/assets/f3f1a525-1337-4b49-8ab3-7ec538eec2e2)


Pour exploiter la vulnérabilité, un dossier appelé external est créé pour y stocker le fichier de la charge utile malveillante qui sera envoyé à ActiveMQ:
mkdir external
![Capture d’écran 2024-10-29 à 11 29 49](https://github.com/user-attachments/assets/30b6afcf-3642-4be8-9c88-c4ad88f9852a)

Ensuite, pour exploiter la vulnérabilité, une commande Java est exécutée pour envoyer une charge utile à ActiveMQ. Cette charge crée un fichier success dans le dossier /tmp du conteneur ActiveMQ :
(Sur mon GitHub, je n'ai pas réussi à ajouter le fichier .jar car il est trop volumineux. Voici donc le lien pour le télécharger et le placer dans le dossier activemq_2015 : https://github.com/matthiaskaiser/jmet/releases)

java -jar jmet-0.1.0-all.jar -Q event -I ActiveMQ -s -Y "touch /tmp/success" -Yp ROME 192.168.1.145 61616
![Capture d’écran 2024-10-29 à 11 59 47](https://github.com/user-attachments/assets/1cf96446-9765-4ba1-ba47-430dd2d12fdd)


Dans l'interface d'ActiveMQ, dans l'onglet Queues, le message injecté est visible. Cela indique que la requête a bien été envoyée :
![Capture d’écran 2024-10-29 à 11 39 48](https://github.com/user-attachments/assets/2f1d85a9-0f23-4b35-8fd2-8c11541d8120)

Le message est ensuite consommé pour s’assurer qu'il est bien pris en charge par ActiveMQ, ce qui devrait déclencher l'exécution de la commande dans le conteneur.

![Capture d’écran 2024-10-29 à 11 41 06](https://github.com/user-attachments/assets/98d0de92-e537-4ffc-8afd-fc0e4d1b3cb4)
![Capture d’écran 2024-10-29 à 11 41 25](https://github.com/user-attachments/assets/0898297a-680a-4cc6-bd06-8f94cb8fc310)


Pour vérifier le succès de l’injection, la liste des conteneurs en cours d'exécution est affichée pour obtenir l'ID du conteneur ActiveMQ :
docker ps -a

![Capture d’écran 2024-10-29 à 11 37 29](https://github.com/user-attachments/assets/a31e82c3-a845-4af4-ac48-abe4ee5e2024)

Maintenant qu'on a l'ID, on peut grace à cette commande entrer dans le container:
docker exec -it 1af7c9cfac3c /bin/bash

![Capture d’écran 2024-10-29 à 11 38 54](https://github.com/user-attachments/assets/a1449b45-b334-47a7-83fb-da2ba883e82b)

Nous allons nous rendre dans le fichier /tmp pour voir si success a bien été injecté:

![Capture d’écran 2024-10-29 à 11 42 31](https://github.com/user-attachments/assets/65d0490b-26b4-4f6e-aabb-4f77f0901cb0)

Nous pouvons voir que success est bien présent, donc que l'injection s'est bien passé.
